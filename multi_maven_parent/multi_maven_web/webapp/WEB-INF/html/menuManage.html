<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Custom DataGrid Pager - jQuery EasyUI Demo</title>
<link rel="stylesheet" type="text/css"
	href="../easyui/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="../easyui/themes/icon.css">
<link rel="stylesheet" type="text/css" href="../easyui/demo/demo.css">
<script type="text/javascript" src="../easyui/jquery.min.js"></script>
<script type="text/javascript" src="../easyui/jquery.easyui.min.js"></script>
<style type="text/css">
label{
	width: 53px;
    display: inline-block;
    padding-bottom: 10px;}
</style>
</head>
<body>
	<h2>菜单管理</h2>
	<p>You can append some buttons to the standard datagrid pager bar.</p>
	<div style="margin: 20px 0;"></div>
	<table id="dg" title="Custom DataGrid Pager" toolbar="#tb"
		style="width: 100%; height: 250px"
		data-options="rownumbers:true,singleSelect:true,pagination:true,method:'get'">
		<thead>
			<tr>
				<th data-options="field:'menu_id',width:100">Item ID</th>
				<th data-options="field:'name',width:fixWidth(0.1)">Name</th>
				<th data-options="field:'parentId',width:fixWidth(0.1),align:'right'">父级ID</th>
				<th data-options="field:'type',width:fixWidth(0.1),align:'right'">类型</th>
				<th data-options="field:'resUrl',width:fixWidth(0.1),align:'right'">链接</th>
				<th data-options="field:'sort',width:fixWidth(0.1),align:'right'">排序</th>
				<th data-options="field:'isValid',width:fixWidth(0.1),align:'right'">是否有效</th>
				<th data-options="field:'description',width:fixWidth(0.1),align:'right'">描述</th>
			</tr>
		</thead>
	</table>
	<div id="dlg" class="easyui-dialog"
		style="width: 400px; height: 350px; padding: 10px 20px" closed="true"
		buttons="#dlg-buttons">
		<div class="ftitle">User Information</div>

		<form id="fm">
			<div class="fitem">
				<input name="id" value="0" type="hidden" /> <label>名字:</label> <input
					name="name" class="easyui-validatebox" required="true">
			</div>
			<div class="fitem">
				<label>父级ID:</label> <input name="parentId"
					class="easyui-validatebox" required="true">
			</div>
			<div class="fitem">
				<label>类型:</label> <input name="type" class="easyui-validatebox"
					required="true">
			</div>
			<div class="fitem">
				<label>链接:</label> <input name="resUrl" class="easyui-validatebox">
			</div>
			<div class="fitem">
				<label>图标:</label> <input name="icon" class="easyui-validatebox"
					required="true">
			</div>
			<div class="fitem">
				<label>排序值:</label> <input name="sort" class="easyui-validatebox"
					required="true">
			</div>
			<div class="fitem">
				<label>是否可用:</label> <input name="isValid"
					class="easyui-validatebox" required="true">
			</div>
			<div class="fitem">
				<label>描述:</label> <input name="description"
					class="easyui-validatebox" required="true">
			</div>
		</form>
	</div>
	<div id="dlg-buttons">
		<a href="#" class="easyui-linkbutton" iconCls="icon-ok"
			onclick="saveUser()">Save</a> <a href="#" class="easyui-linkbutton"
			iconCls="icon-cancel" onclick="javascript:$('#dlg').dialog('close')">Cancel</a>
	</div>
	<div id="tb">
		<a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true"
			onclick="javascript:alert('Add')">Add</a> <a href="#"
			class="easyui-linkbutton" iconCls="icon-cut" plain="true"
			onclick="javascript:alert('Cut')">Cut</a> <a href="#"
			class="easyui-linkbutton" iconCls="icon-save" plain="true"
			onclick="javascript:alert('Save')">Save</a>
	</div>
	<div id="dd" > </div>

	<script type="text/javascript">
		$(function() {
			$('#dg').datagrid({
				onSelect : function(index, row) {
					//alert(row.menu_id);
					$("#dd").dialog({
						title: "title",
		                width: 300,
		                height: 200,
		                closed: false,
		                cache: true,
		                collapsible:true,
		                queryParams: { checksysno: row.menu_id },
		                content:"you want to delete data where "+row.menu_id,
		                modal: true,
		                buttons: [{
							text:'Ok',
							iconCls:'icon-ok',
							handler:function(){
								//alert('ok'+row.menu_id);
								 $.ajax({
									url : "../permission/deleteMenu",
									data : {
										"menu_id" : row.menu_id
									},
									dataType : "json",
									success : function(data) {
										$('#dg').datagrid('reload');
									}
								}) 
								$("#dd").dialog("close")
							}
						},{
							text:'Cancel',
							handler:function(){
								//alert('cancel');
								$("#dd").dialog("close")
							}
						}]
					});
					/*  $("#dd").append("你确定要删除"+row.username);
					 $('#dd').dialog({    
					    title: 'My Dialog',    
					    width: 200,    
					    height: 100,    
					    //modal: true,
					    buttons:$("#dd")
					});  */
					
				}
			});
			var pager = $('#dg').datagrid({
				url : '../permission/findAllMenu'
			}).datagrid('getPager'); // get the pager of datagrid
			pager.pagination({
				buttons : [
						{
							iconCls : 'icon-search',
							handler : function() {
								alert('search');
							}
						},
						{
							iconCls : 'icon-add',
							handler : function() {
								$('#dlg').dialog('open').dialog('setTitle',
										'New User');
								$('#fm').form('clear');

							}
						}, {
							iconCls : 'icon-edit',
							handler : function() {
								alert('edit');
							}
						} ]
			});

		});
		function fixWidth(percent) {
			return document.body.clientWidth * percent;//根据自身情况更改
		}
		function saveUser() {
			$.ajax({
				url : "../permission/addMenu",
				data : $("#fm").serialize(),
				dataType : "json",
				success : function(data) {
					$('#dlg').dialog('close');
					$('#dg').datagrid('reload');
				}
			})
		}
	</script>
</body>
</html>